diff --git a/.idea/workspace.xml b/.idea/workspace.xml
index eae739c..5483b9f 100644
--- a/.idea/workspace.xml
+++ b/.idea/workspace.xml
@@ -4,7 +4,8 @@
     <list default="true" id="fe72474c-d158-4d71-bfb4-aff9b2b6bdbf" name="Default Changelist" comment="">
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/models/Ours.py" beforeDir="false" afterPath="$PROJECT_DIR$/models/Ours.py" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/train_ours.py" beforeDir="false" afterPath="$PROJECT_DIR$/train_ours.py" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/wandb/debug.log" beforeDir="false" afterPath="$PROJECT_DIR$/wandb/debug.log" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/wandb/run-20191110_113825-bv0vw1nm/wandb-metadata.json" beforeDir="false" afterPath="$PROJECT_DIR$/wandb/run-20191110_113825-bv0vw1nm/wandb-metadata.json" afterDir="false" />
     </list>
     <option name="EXCLUDED_CONVERTED_TO_IGNORED" value="true" />
     <option name="SHOW_DIALOG" value="false" />
@@ -194,15 +195,6 @@
     </task>
     <servers />
   </component>
-  <component name="TodoView">
-    <todo-panel id="selected-file">
-      <is-autoscroll-to-source value="true" />
-    </todo-panel>
-    <todo-panel id="all">
-      <are-packages-shown value="true" />
-      <is-autoscroll-to-source value="true" />
-    </todo-panel>
-  </component>
   <component name="Vcs.Log.Tabs.Properties">
     <option name="TAB_STATES">
       <map>
@@ -219,13 +211,18 @@
       <breakpoints>
         <line-breakpoint enabled="true" suspend="THREAD" type="python-line">
           <url>file://$PROJECT_DIR$/models/Ours.py</url>
-          <line>50</line>
-          <option name="timeStamp" value="1" />
+          <line>61</line>
+          <option name="timeStamp" value="6" />
+        </line-breakpoint>
+        <line-breakpoint enabled="true" suspend="THREAD" type="python-line">
+          <url>file://$PROJECT_DIR$/models/Ours.py</url>
+          <line>59</line>
+          <option name="timeStamp" value="7" />
         </line-breakpoint>
         <line-breakpoint enabled="true" suspend="THREAD" type="python-line">
           <url>file://$PROJECT_DIR$/models/Ours.py</url>
-          <line>32</line>
-          <option name="timeStamp" value="2" />
+          <line>20</line>
+          <option name="timeStamp" value="8" />
         </line-breakpoint>
       </breakpoints>
     </breakpoint-manager>
diff --git a/models/Ours.py b/models/Ours.py
index 5615413..7ff746f 100644
--- a/models/Ours.py
+++ b/models/Ours.py
@@ -10,17 +10,18 @@ class OurNetwork(nn.Module):
                  n_classes,
                  n_layers,
                  n_nodes,
-                 use_linear_comb=True,
-                 use_intermediate_embedding=True,
+                 use_linear_comb=False,
+                 use_intermediate_embedding=False,
                  activation=torch.relu,
                  dropout=0.5):
         super(OurNetwork, self).__init__()
         self.layers = nn.ModuleList()
+        self.num_layers = n_layers
         # input layer
         self.layers.append(
             OurLayer(input_dim, n_hidden, n_nodes, activation=activation, use_linear_comb=use_linear_comb))
         # hidden layers
-        for i in range(n_layers - 1):
+        for i in range(n_layers-1):
             self.layers.append(
                 OurLayer(n_hidden, n_hidden, n_nodes, activation=activation, use_linear_comb=use_linear_comb))
         # output layer
@@ -30,8 +31,8 @@ class OurNetwork(nn.Module):
         self.use_intermediate_embedding = use_intermediate_embedding
         if use_intermediate_embedding:
             self.intermediate_layer = nn.ModuleList()
-            self.intermediate_layer.append(nn.Linear(input_dim, n_classes))
-            for i in range(n_layers - 1):
+            # self.intermediate_layer.append(nn.Linear(input_dim, n_classes))
+            for i in range(n_layers):
                 self.intermediate_layer.append(nn.Linear(n_hidden, n_classes))
             self.out_layer = nn.Linear(n_layers+1, n_classes)
 
@@ -39,16 +40,17 @@ class OurNetwork(nn.Module):
         if self.use_intermediate_embedding:
             intermediate_embeddings = []
             h = features
-            intermediate_embeddings.append(h)
             for i, layer in enumerate(self.layers):
                 if i != 0:
                     h = self.dropout(h)
-                h = layer(graph, h)
-                intermediate_embedding = self.intermediate_layer[i](h)  # shape = (# nodes * num_out)
-                intermediate_embedding.append(intermediate_embedding)
+                h = layer(graph, h) # shape = (# nodes * hidden)
+                if i != self.num_layers:
+                    intermediate_embedding = self.intermediate_layer[i](h)  # shape = (# nodes * num_classes)
+                    intermediate_embeddings.append(intermediate_embedding)
 
-            concatenated_intermediate_features = torch.cat(intermediate_embeddings, dim=-1)
-            out = self.out_layer(concatenated_intermediate_features)
+            intermediate_embeddings.append(h)
+            stacked_intermediate_embeddings = torch.stack(intermediate_embeddings)
+            out = stacked_intermediate_embeddings.sum(1)
 
         else:
             h = features
diff --git a/models/__pycache__/Ours.cpython-37.pyc b/models/__pycache__/Ours.cpython-37.pyc
index b67059b..de7b980 100644
Binary files a/models/__pycache__/Ours.cpython-37.pyc and b/models/__pycache__/Ours.cpython-37.pyc differ
diff --git a/wandb/debug.log b/wandb/debug.log
index 87a52e8..c03b53a 100644
--- a/wandb/debug.log
+++ b/wandb/debug.log
@@ -1,19 +1,19 @@
-2019-11-10 20:38:28,340 DEBUG   MainThread:12736 [wandb_config.py:_load_defaults():110] no defaults not found in config-defaults.yaml
-2019-11-10 20:38:28,383 DEBUG   MainThread:12736 [util.py:is_cygwin_git():318] Failed checking if running in CYGWIN due to: FileNotFoundError(2, 'The system cannot find the file specified', None, 2, None)
-2019-11-10 20:38:28,388 DEBUG   MainThread:12736 [cmd.py:execute():724] Popen(['git', 'cat-file', '--batch-check'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=<valid stream>)
-2019-11-10 20:38:28,458 DEBUG   MainThread:12736 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-10 20:38:28,526 DEBUG   MainThread:12736 [cmd.py:execute():724] Popen(['git', 'status', '--porcelain', '--untracked-files'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-10 20:38:28,604 DEBUG   MainThread:12736 [run_manager.py:__init__():535] Initialized sync for gnnproject/bv0vw1nm
-2019-11-10 20:38:28,613 INFO    MainThread:12736 [run_manager.py:wrap_existing_process():1131] wrapping existing process 2204
-2019-11-10 20:38:28,618 DEBUG   MainThread:12736 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): pypi.org:443
-2019-11-10 20:38:29,229 DEBUG   MainThread:12736 [connectionpool.py:_make_request():437] https://pypi.org:443 "GET /pypi/wandb/json HTTP/1.1" 200 37669
-2019-11-10 20:38:29,367 INFO    Thread-18 :12736 [run_manager.py:_on_file_created():671] file/dir created: C:\Users\kyuree\dev\ai601\wandb\run-20191110_113825-bv0vw1nm\wandb-metadata.json
-2019-11-10 20:38:29,558 INFO    MainThread:12736 [run_manager.py:init_run():916] system metrics and metadata threads started
-2019-11-10 20:38:29,558 INFO    MainThread:12736 [run_manager.py:init_run():950] upserting run before process can begin, waiting at most 10 seconds
-2019-11-10 20:38:29,595 DEBUG   Thread-43 :12736 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-10 20:38:30,073 DEBUG   Thread-43 :12736 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 484
-2019-11-10 20:38:30,110 INFO    Thread-43 :12736 [run_manager.py:_upsert_run():1035] saving patches
-2019-11-10 20:38:30,112 DEBUG   Thread-43 :12736 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-10 20:38:30,197 DEBUG   Thread-43 :12736 [cmd.py:execute():724] Popen(['git', 'diff', '--cached', '--abbrev=40', '--full-index', '--raw'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-10 20:38:30,260 DEBUG   Thread-43 :12736 [cmd.py:execute():724] Popen(['git', 'diff', '--abbrev=40', '--full-index', '--raw'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-10 20:38:30,354 DEBUG   Thread-43 :12736 [cmd.py:execute():724] Popen(['git', 'version'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-10 21:04:10,353 DEBUG   MainThread:9616 [wandb_config.py:_load_defaults():110] no defaults not found in config-defaults.yaml
+2019-11-10 21:04:10,395 DEBUG   MainThread:9616 [util.py:is_cygwin_git():318] Failed checking if running in CYGWIN due to: FileNotFoundError(2, 'The system cannot find the file specified', None, 2, None)
+2019-11-10 21:04:10,399 DEBUG   MainThread:9616 [cmd.py:execute():724] Popen(['git', 'cat-file', '--batch-check'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=<valid stream>)
+2019-11-10 21:04:10,458 DEBUG   MainThread:9616 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-10 21:04:10,520 DEBUG   MainThread:9616 [cmd.py:execute():724] Popen(['git', 'status', '--porcelain', '--untracked-files'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-10 21:04:10,597 DEBUG   MainThread:9616 [run_manager.py:__init__():535] Initialized sync for gnnproject/5ktzzst2
+2019-11-10 21:04:10,607 INFO    MainThread:9616 [run_manager.py:wrap_existing_process():1131] wrapping existing process 18076
+2019-11-10 21:04:10,612 DEBUG   MainThread:9616 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): pypi.org:443
+2019-11-10 21:04:11,305 DEBUG   MainThread:9616 [connectionpool.py:_make_request():437] https://pypi.org:443 "GET /pypi/wandb/json HTTP/1.1" 200 37669
+2019-11-10 21:04:11,380 INFO    Thread-18 :9616 [run_manager.py:_on_file_created():671] file/dir created: C:\Users\kyuree\dev\ai601\wandb\run-20191110_120407-5ktzzst2\output.log
+2019-11-10 21:04:11,647 INFO    MainThread:9616 [run_manager.py:init_run():916] system metrics and metadata threads started
+2019-11-10 21:04:11,648 INFO    MainThread:9616 [run_manager.py:init_run():950] upserting run before process can begin, waiting at most 10 seconds
+2019-11-10 21:04:11,684 DEBUG   Thread-43 :9616 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
+2019-11-10 21:04:12,074 DEBUG   Thread-43 :9616 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 484
+2019-11-10 21:04:12,086 INFO    Thread-43 :9616 [run_manager.py:_upsert_run():1035] saving patches
+2019-11-10 21:04:12,087 DEBUG   Thread-43 :9616 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-10 21:04:12,151 DEBUG   Thread-43 :9616 [cmd.py:execute():724] Popen(['git', 'diff', '--cached', '--abbrev=40', '--full-index', '--raw'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-10 21:04:12,224 DEBUG   Thread-43 :9616 [cmd.py:execute():724] Popen(['git', 'diff', '--abbrev=40', '--full-index', '--raw'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-10 21:04:12,325 DEBUG   Thread-43 :9616 [cmd.py:execute():724] Popen(['git', 'version'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
diff --git a/wandb/run-20191110_113825-bv0vw1nm/wandb-metadata.json b/wandb/run-20191110_113825-bv0vw1nm/wandb-metadata.json
index ecd87af..ce895a3 100644
--- a/wandb/run-20191110_113825-bv0vw1nm/wandb-metadata.json
+++ b/wandb/run-20191110_113825-bv0vw1nm/wandb-metadata.json
@@ -19,5 +19,5 @@
     "mode": "run",
     "name": "DEBUG",
     "project": "gnnproject",
-    "heartbeatAt": "2019-11-10T11:38:45.572610"
+    "heartbeatAt": "2019-11-10T11:41:09.769356"
 }
