diff --git a/.idea/workspace.xml b/.idea/workspace.xml
index d7eba33..412bf0a 100644
--- a/.idea/workspace.xml
+++ b/.idea/workspace.xml
@@ -2,16 +2,14 @@
 <project version="4">
   <component name="ChangeListManager">
     <list default="true" id="fe72474c-d158-4d71-bfb4-aff9b2b6bdbf" name="Default Changelist" comment="">
-      <change afterPath="$PROJECT_DIR$/Readme.md" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/models/graphconv.py" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/requirements.txt" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/.idea/ai601.iml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/ai601.iml" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/.idea/misc.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/misc.xml" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/train_gat.py" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/utils/train_utils.py" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/gcn" beforeDir="false" afterPath="$PROJECT_DIR$/gcn" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/gcn/requirements.txt" beforeDir="false" />
-      <change beforePath="$PROJECT_DIR$/models/GCN.py" beforeDir="false" afterPath="$PROJECT_DIR$/models/GCN.py" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/models/GAT.py" beforeDir="false" afterPath="$PROJECT_DIR$/models/GAT.py" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/train.py" beforeDir="false" afterPath="$PROJECT_DIR$/train.py" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/wandb/debug.log" beforeDir="false" afterPath="$PROJECT_DIR$/wandb/debug.log" afterDir="false" />
     </list>
     <option name="EXCLUDED_CONVERTED_TO_IGNORED" value="true" />
     <option name="SHOW_DIALOG" value="false" />
@@ -24,25 +22,13 @@
       <content type="file-editors">
         <state>
           <leaf>
-            <file pinned="false" current-in-tab="false">
-              <entry file="file://$PROJECT_DIR$/models/GCN.py">
-                <provider selected="true" editor-type-id="text-editor">
-                  <state relative-caret-position="272">
-                    <caret line="16" column="31" selection-start-line="16" selection-start-column="31" selection-end-line="16" selection-end-column="31" />
-                    <folding>
-                      <element signature="e#0#12#0" expanded="true" />
-                    </folding>
-                  </state>
-                </provider>
-              </entry>
-            </file>
             <file pinned="false" current-in-tab="true">
-              <entry file="file://$PROJECT_DIR$/models/graphconv.py">
+              <entry file="file://$PROJECT_DIR$/models/GAT.py">
                 <provider selected="true" editor-type-id="text-editor">
-                  <state relative-caret-position="143">
-                    <caret line="60" column="26" selection-start-line="60" selection-start-column="26" selection-end-line="60" selection-end-column="26" />
+                  <state relative-caret-position="697">
+                    <caret line="41" selection-start-line="41" selection-end-line="41" />
                     <folding>
-                      <element signature="e#49#67#0" expanded="true" />
+                      <element signature="e#0#12#0" expanded="true" />
                     </folding>
                   </state>
                 </provider>
@@ -58,20 +44,26 @@
       <file pinned="false" current-in-tab="true">
         <entry file="file://$PROJECT_DIR$/train.py">
           <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="357">
-              <caret line="80" column="61" lean-forward="true" selection-start-line="80" selection-start-column="61" selection-end-line="80" selection-end-column="61" />
-              <folding>
-                <element signature="e#0#12#0" expanded="true" />
-              </folding>
+            <state relative-caret-position="85">
+              <caret line="5" column="38" selection-start-line="5" selection-start-column="38" selection-end-line="5" selection-end-column="38" />
+            </state>
+          </provider>
+        </entry>
+      </file>
+      <file pinned="false" current-in-tab="false">
+        <entry file="file://$PROJECT_DIR$/utils/train_utils.py">
+          <provider selected="true" editor-type-id="text-editor">
+            <state relative-caret-position="136">
+              <caret line="8" column="35" selection-start-line="8" selection-start-column="35" selection-end-line="8" selection-end-column="35" />
             </state>
           </provider>
         </entry>
       </file>
       <file pinned="false" current-in-tab="false">
-        <entry file="file://$USER_HOME$/Anaconda3/envs/ai601_env/Lib/site-packages/torch/nn/modules/module.py">
+        <entry file="file://$PROJECT_DIR$/train_gat.py">
           <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="172">
-              <caret line="540" selection-start-line="540" selection-end-line="540" />
+            <state relative-caret-position="102">
+              <caret line="6" column="35" selection-start-line="6" selection-start-column="35" selection-end-line="6" selection-end-column="35" />
             </state>
           </provider>
         </entry>
@@ -90,6 +82,11 @@
       <find>features</find>
       <find>feat</find>
       <find>acc</find>
+      <find>l</find>
+      <find>graph.</find>
+      <find>identity</find>
+      <find>edge_softmax</find>
+      <find>self.fc</find>
     </findStrings>
   </component>
   <component name="Git.Settings">
@@ -109,15 +106,19 @@
         <option value="$PROJECT_DIR$/requirements.txt" />
         <option value="$PROJECT_DIR$/models/GCN.py" />
         <option value="$PROJECT_DIR$/models/graphconv.py" />
+        <option value="$PROJECT_DIR$/models/gatlayer.py" />
+        <option value="$PROJECT_DIR$/utils/train_utils.py" />
+        <option value="$PROJECT_DIR$/models/GAT.py" />
+        <option value="$PROJECT_DIR$/train_gat.py" />
         <option value="$PROJECT_DIR$/train.py" />
       </list>
     </option>
   </component>
   <component name="ProjectFrameBounds" extendedState="6">
-    <option name="x" value="44" />
-    <option name="y" value="275" />
-    <option name="width" value="1327" />
-    <option name="height" value="758" />
+    <option name="x" value="191" />
+    <option name="y" value="19" />
+    <option name="width" value="1395" />
+    <option name="height" value="1056" />
   </component>
   <component name="ProjectLevelVcsManager" settingsEditedManually="true" />
   <component name="ProjectView">
@@ -125,6 +126,7 @@
       <foldersAlwaysOnTop value="true" />
     </navigator>
     <panes>
+      <pane id="Scope" />
       <pane id="ProjectPane">
         <subPane>
           <expand>
@@ -142,6 +144,11 @@
               <item name="ai601" type="462c0819:PsiDirectoryNode" />
               <item name="models" type="462c0819:PsiDirectoryNode" />
             </path>
+            <path>
+              <item name="ai601" type="b2602c69:ProjectViewProjectNode" />
+              <item name="ai601" type="462c0819:PsiDirectoryNode" />
+              <item name="utils" type="462c0819:PsiDirectoryNode" />
+            </path>
             <path>
               <item name="ai601" type="b2602c69:ProjectViewProjectNode" />
               <item name="External Libraries" type="cb654da1:ExternalLibrariesNode" />
@@ -150,12 +157,11 @@
           <select />
         </subPane>
       </pane>
-      <pane id="Scope" />
     </panes>
   </component>
   <component name="PropertiesComponent">
     <property name="SHARE_PROJECT_CONFIGURATION_FILES" value="true" />
-    <property name="last_opened_file_path" value="$PROJECT_DIR$" />
+    <property name="last_opened_file_path" value="$PROJECT_DIR$/../jssp" />
     <property name="settings.editor.selected.configurable" value="com.jetbrains.python.configuration.PyActiveSdkModuleConfigurable" />
   </component>
   <component name="RecentsManager">
@@ -176,7 +182,7 @@
     </option>
   </component>
   <component name="RunManager" selected="Python.train">
-    <configuration name="1_gcn" type="PythonConfigurationType" factoryName="Python" temporary="true">
+    <configuration name="GAT" type="PythonConfigurationType" factoryName="Python" temporary="true">
       <module name="ai601" />
       <option name="INTERPRETER_OPTIONS" value="" />
       <option name="PARENT_ENVS" value="true" />
@@ -184,11 +190,11 @@
         <env name="PYTHONUNBUFFERED" value="1" />
       </envs>
       <option name="SDK_HOME" value="" />
-      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$" />
+      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$/models" />
       <option name="IS_MODULE_SDK" value="true" />
       <option name="ADD_CONTENT_ROOTS" value="true" />
       <option name="ADD_SOURCE_ROOTS" value="true" />
-      <option name="SCRIPT_NAME" value="$PROJECT_DIR$/1_gcn.py" />
+      <option name="SCRIPT_NAME" value="$PROJECT_DIR$/models/GAT.py" />
       <option name="PARAMETERS" value="" />
       <option name="SHOW_COMMAND_LINE" value="false" />
       <option name="EMULATE_TERMINAL" value="false" />
@@ -260,12 +266,34 @@
       <option name="INPUT_FILE" value="" />
       <method v="2" />
     </configuration>
+    <configuration name="train_gat" type="PythonConfigurationType" factoryName="Python" temporary="true">
+      <module name="ai601" />
+      <option name="INTERPRETER_OPTIONS" value="" />
+      <option name="PARENT_ENVS" value="true" />
+      <envs>
+        <env name="PYTHONUNBUFFERED" value="1" />
+      </envs>
+      <option name="SDK_HOME" value="" />
+      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$" />
+      <option name="IS_MODULE_SDK" value="true" />
+      <option name="ADD_CONTENT_ROOTS" value="true" />
+      <option name="ADD_SOURCE_ROOTS" value="true" />
+      <option name="SCRIPT_NAME" value="$PROJECT_DIR$/train_gat.py" />
+      <option name="PARAMETERS" value="" />
+      <option name="SHOW_COMMAND_LINE" value="false" />
+      <option name="EMULATE_TERMINAL" value="false" />
+      <option name="MODULE_MODE" value="false" />
+      <option name="REDIRECT_INPUT" value="false" />
+      <option name="INPUT_FILE" value="" />
+      <method v="2" />
+    </configuration>
     <recent_temporary>
       <list>
         <item itemvalue="Python.train" />
+        <item itemvalue="Python.train_gat" />
+        <item itemvalue="Python.GAT" />
         <item itemvalue="Python.GraphConvolutionalNetwork" />
         <item itemvalue="Python.load_data" />
-        <item itemvalue="Python.1_gcn" />
       </list>
     </recent_temporary>
   </component>
@@ -295,13 +323,13 @@
     <frame x="-8" y="-8" width="1936" height="1056" extended-state="6" />
     <editor active="true" />
     <layout>
-      <window_info content_ui="combo" id="Project" order="0" visible="true" weight="0.13224447" />
+      <window_info content_ui="combo" id="Project" order="0" visible="true" weight="0.15700738" />
       <window_info id="Structure" order="1" side_tool="true" weight="0.25" />
       <window_info id="Favorites" order="2" side_tool="true" />
       <window_info anchor="bottom" id="Message" order="0" />
-      <window_info anchor="bottom" id="Find" order="1" />
-      <window_info active="true" anchor="bottom" id="Run" order="2" visible="true" weight="0.41386783" />
-      <window_info anchor="bottom" id="Debug" order="3" weight="0.3997833" />
+      <window_info anchor="bottom" id="Find" order="1" weight="0.32936078" />
+      <window_info active="true" anchor="bottom" id="Run" order="2" visible="true" weight="0.48754063" />
+      <window_info anchor="bottom" id="Debug" order="3" weight="0.5471289" />
       <window_info anchor="bottom" id="Cvs" order="4" weight="0.25" />
       <window_info anchor="bottom" id="Inspection" order="5" weight="0.4" />
       <window_info anchor="bottom" id="TODO" order="6" weight="0.22318527" />
@@ -314,6 +342,17 @@
       <window_info anchor="right" content_ui="combo" id="Hierarchy" order="2" weight="0.25" />
     </layout>
   </component>
+  <component name="XDebuggerManager">
+    <breakpoint-manager>
+      <breakpoints>
+        <line-breakpoint enabled="true" suspend="THREAD" type="python-line">
+          <url>file://$PROJECT_DIR$/utils/train_utils.py</url>
+          <line>9</line>
+          <option name="timeStamp" value="8" />
+        </line-breakpoint>
+      </breakpoints>
+    </breakpoint-manager>
+  </component>
   <component name="editorHistoryManager">
     <entry file="file://$PROJECT_DIR$/gcn/gcn/train.py">
       <provider selected="true" editor-type-id="text-editor">
@@ -370,16 +409,6 @@
         </state>
       </provider>
     </entry>
-    <entry file="file://$PROJECT_DIR$/models/GAT.py">
-      <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="221">
-          <caret line="13" column="23" selection-start-line="13" selection-start-column="23" selection-end-line="13" selection-end-column="23" />
-          <folding>
-            <element signature="e#0#12#0" expanded="true" />
-          </folding>
-        </state>
-      </provider>
-    </entry>
     <entry file="file://$PROJECT_DIR$/1_gcn.py">
       <provider selected="true" editor-type-id="text-editor">
         <state relative-caret-position="85">
@@ -452,32 +481,87 @@
         </state>
       </provider>
     </entry>
+    <entry file="file://$PROJECT_DIR$/models/graphconv.py">
+      <provider selected="true" editor-type-id="text-editor">
+        <state relative-caret-position="143">
+          <caret line="60" column="26" selection-start-line="60" selection-start-column="26" selection-end-line="60" selection-end-column="26" />
+          <folding>
+            <element signature="e#49#67#0" expanded="true" />
+          </folding>
+        </state>
+      </provider>
+    </entry>
     <entry file="file://$USER_HOME$/Anaconda3/envs/ai601_env/Lib/site-packages/torch/nn/modules/module.py">
       <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="172">
+        <state relative-caret-position="9078">
           <caret line="540" selection-start-line="540" selection-end-line="540" />
         </state>
       </provider>
     </entry>
-    <entry file="file://$PROJECT_DIR$/models/graphconv.py">
+    <entry file="file://$PROJECT_DIR$/models/gatlayer.py">
       <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="143">
-          <caret line="60" column="26" selection-start-line="60" selection-start-column="26" selection-end-line="60" selection-end-column="26" />
+        <state relative-caret-position="136">
+          <caret line="8" lean-forward="true" selection-start-line="8" selection-end-line="8" />
           <folding>
-            <element signature="e#49#67#0" expanded="true" />
+            <element signature="e#116#134#0" expanded="true" />
           </folding>
         </state>
       </provider>
     </entry>
-    <entry file="file://$PROJECT_DIR$/train.py">
+    <entry file="file://$USER_HOME$/Anaconda3/envs/ai601_env/Lib/site-packages/torch/nn/functional.py">
+      <provider selected="true" editor-type-id="text-editor">
+        <state relative-caret-position="652">
+          <caret line="1371" selection-start-line="1371" selection-end-line="1371" />
+        </state>
+      </provider>
+    </entry>
+    <entry file="file://$USER_HOME$/Anaconda3/envs/ai601_env/Lib/site-packages/dgl/nn/pytorch/conv/gatconv.py">
+      <provider selected="true" editor-type-id="text-editor">
+        <state relative-caret-position="133">
+          <caret line="80" column="22" selection-start-line="80" selection-start-column="22" selection-end-line="80" selection-end-column="22" />
+          <folding>
+            <element signature="e#116#134#0" expanded="true" />
+          </folding>
+        </state>
+      </provider>
+    </entry>
+    <entry file="file://$PROJECT_DIR$/models/GAT.py">
       <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="357">
-          <caret line="80" column="61" lean-forward="true" selection-start-line="80" selection-start-column="61" selection-end-line="80" selection-end-column="61" />
+        <state relative-caret-position="697">
+          <caret line="41" selection-start-line="41" selection-end-line="41" />
           <folding>
             <element signature="e#0#12#0" expanded="true" />
           </folding>
         </state>
       </provider>
     </entry>
+    <entry file="file://$USER_HOME$/Anaconda3/envs/ai601_env/Lib/site-packages/numpy/core/fromnumeric.py">
+      <provider selected="true" editor-type-id="text-editor">
+        <state relative-caret-position="131">
+          <caret line="3256" selection-start-line="3256" selection-end-line="3256" />
+        </state>
+      </provider>
+    </entry>
+    <entry file="file://$PROJECT_DIR$/train_gat.py">
+      <provider selected="true" editor-type-id="text-editor">
+        <state relative-caret-position="102">
+          <caret line="6" column="35" selection-start-line="6" selection-start-column="35" selection-end-line="6" selection-end-column="35" />
+        </state>
+      </provider>
+    </entry>
+    <entry file="file://$PROJECT_DIR$/utils/train_utils.py">
+      <provider selected="true" editor-type-id="text-editor">
+        <state relative-caret-position="136">
+          <caret line="8" column="35" selection-start-line="8" selection-start-column="35" selection-end-line="8" selection-end-column="35" />
+        </state>
+      </provider>
+    </entry>
+    <entry file="file://$PROJECT_DIR$/train.py">
+      <provider selected="true" editor-type-id="text-editor">
+        <state relative-caret-position="85">
+          <caret line="5" column="38" selection-start-line="5" selection-start-column="38" selection-end-line="5" selection-end-column="38" />
+        </state>
+      </provider>
+    </entry>
   </component>
 </project>
\ No newline at end of file
Submodule gcn contains modified content
diff --git a/gcn/requirements.txt b/gcn/requirements.txt
deleted file mode 100644
index 23276b8..0000000
--- a/gcn/requirements.txt
+++ /dev/null
@@ -1,5 +0,0 @@
-networkx==2.2
-scipy==1.1.0
-setuptools==40.6.3
-numpy==1.15.4
-tensorflow==1.13.1
diff --git a/models/GAT.py b/models/GAT.py
index 7e41e94..ee509f9 100644
--- a/models/GAT.py
+++ b/models/GAT.py
@@ -6,41 +6,36 @@ from dgl.nn.pytorch import edge_softmax, GATConv
 
 class GAT(nn.Module):
     def __init__(self,
-                 g,
-                 num_layers,
-                 in_dim,
+                 input_dim,
                  num_hidden,
                  num_classes,
-                 heads,
+                 num_layers,
+                 heads=3,
                  activation=torch.relu,
                  feat_drop=0.,
                  attn_drop=0.,
                  negative_slope=0.2,
                  residual=False):
         super(GAT, self).__init__()
-        self.g = g
-        self.num_layers = num_layers
-        self.gat_layers = nn.ModuleList()
-        self.activation = activation
-        # input projection (no residual)
-        self.gat_layers.append(GATConv(
-            in_dim, num_hidden, heads[0],
-            feat_drop, attn_drop, negative_slope, False, self.activation))
-        # hidden layers
-        for l in range(1, num_layers):
+        self.layers = nn.ModuleList()
+
+        self.layers.append(
+            GATConv(input_dim, num_hidden, heads, feat_drop, attn_drop, negative_slope, residual, activation))
+
+        for _ in range(num_layers - 1):
             # due to multi-head, the in_dim = num_hidden * num_heads
-            self.gat_layers.append(GATConv(
-                num_hidden * heads[l - 1], num_hidden, heads[l],
-                feat_drop, attn_drop, negative_slope, residual, self.activation))
+            self.layers.append(GATConv(
+                num_hidden*heads, num_hidden, heads, feat_drop, attn_drop, negative_slope, residual, activation))
         # output projection
-        self.gat_layers.append(GATConv(
-            num_hidden * heads[-2], num_classes, heads[-1],
-            feat_drop, attn_drop, negative_slope, residual, None))
+        self.layers.append(GATConv(
+            num_hidden * heads, num_classes, heads, feat_drop, attn_drop, negative_slope, residual, None))
 
-    def forward(self, inputs):
+    def forward(self, graph, inputs):
         h = inputs
-        for l in range(self.num_layers):
-            h = self.gat_layers[l](self.g, h).flatten(1)
+        for l in range(len(self.layers) - 1):
+            h = self.layers[l](graph, h).flatten(1)
         # output projection
-        logits = self.gat_layers[-1](self.g, h).mean(1)
+        logits = self.layers[-1](graph, h).mean(1)
         return logits
+
+
diff --git a/models/__pycache__/GAT.cpython-37.pyc b/models/__pycache__/GAT.cpython-37.pyc
index a48d047..e84a330 100644
Binary files a/models/__pycache__/GAT.cpython-37.pyc and b/models/__pycache__/GAT.cpython-37.pyc differ
diff --git a/train.py b/train.py
index 80d89bb..0b2f3b4 100644
--- a/train.py
+++ b/train.py
@@ -3,45 +3,34 @@ import argparse, time
 import numpy as np
 
 from models.GCN import GCN
+from utils.train_utils import evaluate
 from models.GAT import GAT
 
-# from utils.load_data import load_cora_data
 from dgl.data import load_data, register_data_args
 from dgl.data.citation_graph import load_cora, load_citeseer, load_pubmed, load_synthetic
 
-
-def evaluate(model, graph, features, labels, mask):
-    model.eval()
-    with torch.no_grad():
-        logits = model(graph, features)
-        logits = logits[mask]
-        labels = labels[mask]
-        _, indices = torch.max(logits, dim=1)
-        correct = torch.sum(indices == labels)
-        return correct.item() * 1.0 / len(labels)
-
-
 if __name__ == "__main__":
     import wandb
     import dgl
 
-    data = load_cora()
+    data = load_citeseer()
 
     graph = dgl.DGLGraph(data.graph)
     features = torch.Tensor(data.features)
-    train_mask = torch.LongTensor(data.train_mask)
-    test_mask = torch.LongTensor(data.test_mask)
-    val_mask = torch.LongTensor(data.val_mask)
+    train_mask = torch.ByteTensor(data.train_mask)
+    test_mask = torch.ByteTensor(data.test_mask)
+    val_mask = torch.ByteTensor(data.val_mask)
     labels = torch.LongTensor(data.labels)
     num_labels = data.num_labels
 
     # model arguments
 
-    input_dim = features.shape[-1]
+    input_dim = features.shape[1]
     n_hidden = 64
-    n_layers = 3
+    n_layers = 2
 
     model = GCN(input_dim, n_hidden, num_labels, n_layers)
+    # model = GAT(input_dim, n_hidden, num_labels, n_layers, heads=3)
 
     # train arguments
 
diff --git a/train_gat.py b/train_gat.py
new file mode 100644
index 0000000..6e34053
--- /dev/null
+++ b/train_gat.py
@@ -0,0 +1,72 @@
+# import wandb
+import dgl
+import networkx as nx
+from dgl.data.citation_graph import load_citeseer
+import time
+import torch
+from utils.train_utils import evaluate
+from models.GAT import GAT
+import numpy as np
+
+if __name__ == "__main__":
+
+    data = load_citeseer()
+
+    g = data.graph
+    g.remove_edges_from(nx.selfloop_edges(g))
+
+    graph = dgl.DGLGraph(g)
+    graph.add_edges(graph.nodes(), graph.nodes())
+
+    features = torch.Tensor(data.features)
+    train_mask = torch.LongTensor(data.train_mask)
+    test_mask = torch.LongTensor(data.test_mask)
+    val_mask = torch.LongTensor(data.val_mask)
+    labels = torch.LongTensor(data.labels)
+    num_labels = data.num_labels
+
+    # model arguments
+
+    input_dim = features.shape[1]
+    n_hidden = 64
+    n_layers = 3
+
+    model = GAT(input_dim=input_dim, num_hidden=n_hidden, num_classes=num_labels, num_layers=n_layers)
+
+    # train arguments
+
+    lr = 1e-3
+    n_epochs = 200
+
+    loss_ftn = torch.nn.CrossEntropyLoss()
+    optimizer = torch.optim.Adam(model.parameters(), lr=lr)
+
+    dur = []
+
+    # wandb.init(project='ai607', name="GCN_cora")
+    # wandb.watch(model)
+
+    n_edges = graph.number_of_edges()
+
+    for epoch in range(n_epochs):
+        model.train()
+        if epoch >= 3:
+            t0 = time.time()
+            # forward
+        logits = model(graph, features)
+        loss = loss_ftn(logits[train_mask], labels[train_mask])
+
+        optimizer.zero_grad()
+        loss.backward()
+        optimizer.step()
+
+        if epoch >= 3:
+            dur.append(time.time() - t0)
+
+        acc = evaluate(model, graph, features, labels, val_mask)
+        print("Epoch {:05d} | Time(s) {:.4f} | Loss {:.4f} | Accuracy {:.4f} | "
+              "ETputs(KTEPS) {:.2f}".format(epoch, np.mean(dur), loss.item(), acc, n_edges / np.mean(dur) / 1000))
+
+    print()
+    acc = evaluate(model, graph, features, labels, test_mask)
+    print("Test Accuracy {:.4f}".format(acc))
diff --git a/utils/train_utils.py b/utils/train_utils.py
new file mode 100644
index 0000000..93a3084
--- /dev/null
+++ b/utils/train_utils.py
@@ -0,0 +1,11 @@
+import torch
+
+def evaluate(model, graph, features, labels, mask):
+    model.eval()
+    with torch.no_grad():
+        logits = model(graph, features)
+        logits = logits[mask]
+        labels = labels[mask]
+        _, indices = torch.max(logits, dim=1)
+        correct = torch.sum(indices == labels)
+        return correct.item() * 1.0 / len(labels)
\ No newline at end of file
diff --git a/wandb/debug.log b/wandb/debug.log
index a777e6d..f109881 100644
--- a/wandb/debug.log
+++ b/wandb/debug.log
@@ -1,65 +1,18 @@
-2019-11-07 14:29:10,619 DEBUG   MainThread:12620 [wandb_config.py:_load_defaults():110] no defaults not found in config-defaults.yaml
-2019-11-07 14:29:10,647 DEBUG   MainThread:12620 [util.py:is_cygwin_git():318] Failed checking if running in CYGWIN due to: FileNotFoundError(2, 'The system cannot find the file specified', None, 2, None)
-2019-11-07 14:29:10,650 DEBUG   MainThread:12620 [cmd.py:execute():724] Popen(['git', 'cat-file', '--batch-check'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=<valid stream>)
-2019-11-07 14:29:10,708 DEBUG   MainThread:12620 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-07 14:29:10,767 DEBUG   MainThread:12620 [cmd.py:execute():724] Popen(['git', 'status', '--porcelain', '--untracked-files'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-07 14:29:10,862 DEBUG   MainThread:12620 [run_manager.py:__init__():535] Initialized sync for ai607/rzpagbj8
-2019-11-07 14:29:10,867 INFO    MainThread:12620 [run_manager.py:wrap_existing_process():1131] wrapping existing process 11848
-2019-11-07 14:29:10,869 DEBUG   MainThread:12620 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): pypi.org:443
-2019-11-07 14:29:11,443 DEBUG   MainThread:12620 [connectionpool.py:_make_request():437] https://pypi.org:443 "GET /pypi/wandb/json HTTP/1.1" 200 37669
-2019-11-07 14:29:11,629 INFO    Thread-7  :12620 [run_manager.py:_on_file_created():671] file/dir created: C:\Users\kyuree\dev\ai601\wandb\run-20191107_052909-rzpagbj8\output.log
-2019-11-07 14:29:11,728 INFO    MainThread:12620 [run_manager.py:init_run():916] system metrics and metadata threads started
-2019-11-07 14:29:11,728 INFO    MainThread:12620 [run_manager.py:init_run():950] upserting run before process can begin, waiting at most 10 seconds
-2019-11-07 14:29:11,744 DEBUG   Thread-20 :12620 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-07 14:29:12,154 DEBUG   Thread-20 :12620 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 473
-2019-11-07 14:29:12,174 INFO    Thread-20 :12620 [run_manager.py:_upsert_run():1035] saving patches
-2019-11-07 14:29:12,174 DEBUG   Thread-20 :12620 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-07 14:29:12,267 DEBUG   Thread-20 :12620 [cmd.py:execute():724] Popen(['git', 'diff', '--cached', '--abbrev=40', '--full-index', '--raw'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-07 14:29:12,337 DEBUG   Thread-20 :12620 [cmd.py:execute():724] Popen(['git', 'version'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-07 14:29:12,503 DEBUG   Thread-20 :12620 [cmd.py:execute():724] Popen(['git', 'merge-base', 'HEAD', '4e6aa86235f21c26dd8cb21c2ae3981cb73f5add'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-07 14:29:12,565 INFO    Thread-20 :12620 [run_manager.py:_upsert_run():1039] saving pip packages
-2019-11-07 14:29:12,566 INFO    Thread-20 :12620 [run_manager.py:_upsert_run():1041] initializing streaming files api
-2019-11-07 14:29:12,566 INFO    Thread-20 :12620 [run_manager.py:_upsert_run():1048] unblocking file change observer, beginning sync with W&B servers
-2019-11-07 14:29:12,567 INFO    MainThread:12620 [run_manager.py:wrap_existing_process():1148] informing user process we are ready to proceed
-2019-11-07 14:29:12,567 INFO    Thread-7  :12620 [run_manager.py:_on_file_created():671] file/dir created: C:\Users\kyuree\dev\ai601\wandb\run-20191107_052909-rzpagbj8\wandb-metadata.json
-2019-11-07 14:29:12,569 INFO    MainThread:12620 [run_manager.py:_sync_etc():1255] entering loop for messages from user process
-2019-11-07 14:29:12,571 DEBUG   Thread-29 :12620 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-07 14:29:12,626 INFO    Thread-7  :12620 [run_manager.py:_on_file_modified():682] file/dir modified: C:\Users\kyuree\dev\ai601\wandb\run-20191107_052909-rzpagbj8\output.log
-2019-11-07 14:29:12,627 INFO    Thread-7  :12620 [run_manager.py:_on_file_modified():682] file/dir modified: C:\Users\kyuree\dev\ai601\wandb\run-20191107_052909-rzpagbj8\config.yaml
-2019-11-07 14:29:12,634 DEBUG   Thread-7  :12620 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-07 14:29:12,936 DEBUG   Thread-29 :12620 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 46
-2019-11-07 14:29:13,023 DEBUG   Thread-7  :12620 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 521
-2019-11-07 14:29:13,031 INFO    Thread-7  :12620 [run_manager.py:_on_file_created():671] file/dir created: C:\Users\kyuree\dev\ai601\wandb\run-20191107_052909-rzpagbj8\wandb-summary.json
-2019-11-07 14:29:13,037 INFO    Thread-7  :12620 [run_manager.py:_on_file_created():671] file/dir created: C:\Users\kyuree\dev\ai601\wandb\run-20191107_052909-rzpagbj8\requirements.txt
-2019-11-07 14:29:13,038 INFO    Thread-7  :12620 [run_manager.py:_on_file_created():671] file/dir created: C:\Users\kyuree\dev\ai601\wandb\run-20191107_052909-rzpagbj8\diff.patch
-2019-11-07 14:29:13,628 INFO    Thread-7  :12620 [run_manager.py:_on_file_modified():682] file/dir modified: C:\Users\kyuree\dev\ai601\wandb\run-20191107_052909-rzpagbj8\wandb-summary.json
-2019-11-07 14:29:13,705 DEBUG   Thread-30 :12620 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-07 14:29:14,071 DEBUG   Thread-30 :12620 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 753
-2019-11-07 14:29:14,078 DEBUG   Thread-30 :12620 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): storage.googleapis.com:443
-2019-11-07 14:29:14,557 DEBUG   Thread-30 :12620 [connectionpool.py:_make_request():437] https://storage.googleapis.com:443 "PUT /wandb-production.appspot.com/sc2rl/ai607/rzpagbj8/___batch_archive_1.tgz?Expires=1573104614&GoogleAccessId=gorilla-cloud-storage%40wandb-production.iam.gserviceaccount.com&Signature=m8v8DYR60TnCB%2F3nDenL5afVgyzAdl31tQZtHxPQevdTqGP3bxzIt5Rg%2F9wPay%2B2BYTQpcX%2Fy1Yli8RsKlCDxukIaVzvHb0aLQhQfZOlFkvZ%2FyBJ%2BJjBLEp39I0e1yrMwnntFNWcIemAJLDRjA0zu3mAI6XVJTLgywuBX7hPyJUiK6qloOC0hifsIB03sViAmWR3hs5uAaEAQVvDNqBRRpHQj%2FMXPIztpSsGm9tokhBCQPXcEESaKUcR3%2BJ4UNCvHXy9nADmYKRe16koKslcz5fjgk1hJ4H4pOJWWUTcJ98iFtrxWKpezb8AlhsEnV3aN4nkkApLnXGDHQfB%2BqJ2Mw%3D%3D HTTP/1.1" 200 0
-2019-11-07 14:29:15,631 DEBUG   Thread-13 :12620 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-07 14:29:16,028 DEBUG   Thread-13 :12620 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /files/sc2rl/ai607/rzpagbj8/file_stream HTTP/1.1" 200 311
-2019-11-07 14:29:19,636 INFO    Thread-7  :12620 [run_manager.py:_on_file_modified():682] file/dir modified: C:\Users\kyuree\dev\ai601\wandb\run-20191107_052909-rzpagbj8\output.log
-2019-11-07 14:29:25,650 INFO    Thread-7  :12620 [run_manager.py:_on_file_modified():682] file/dir modified: C:\Users\kyuree\dev\ai601\wandb\run-20191107_052909-rzpagbj8\output.log
-2019-11-07 14:29:26,575 INFO    MainThread:12620 [run_manager.py:_sync_etc():1278] received message from user process: {"exitcode": 0}
-2019-11-07 14:29:26,575 INFO    MainThread:12620 [run_manager.py:_sync_etc():1364] closing log streams and sending exitcode to W&B
-2019-11-07 14:29:26,576 INFO    MainThread:12620 [run_manager.py:shutdown():1055] shutting down system stats and metadata service
-2019-11-07 14:29:26,652 INFO    Thread-7  :12620 [run_manager.py:_on_file_modified():682] file/dir modified: C:\Users\kyuree\dev\ai601\wandb\run-20191107_052909-rzpagbj8\wandb-summary.json
-2019-11-07 14:29:26,656 INFO    Thread-7  :12620 [run_manager.py:_on_file_modified():682] file/dir modified: C:\Users\kyuree\dev\ai601\wandb\run-20191107_052909-rzpagbj8\output.log
-2019-11-07 14:29:26,657 INFO    Thread-7  :12620 [run_manager.py:_on_file_modified():682] file/dir modified: C:\Users\kyuree\dev\ai601\wandb\run-20191107_052909-rzpagbj8\wandb-history.jsonl
-2019-11-07 14:29:26,662 INFO    Thread-7  :12620 [run_manager.py:_on_file_created():671] file/dir created: C:\Users\kyuree\dev\ai601\wandb\run-20191107_052909-rzpagbj8\wandb-events.jsonl
-2019-11-07 14:29:26,750 INFO    MainThread:12620 [run_manager.py:shutdown():1067] stopping streaming files and file change observer
-2019-11-07 14:29:26,812 DEBUG   Thread-13 :12620 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /files/sc2rl/ai607/rzpagbj8/file_stream HTTP/1.1" 200 311
-2019-11-07 14:29:27,653 INFO    Thread-7  :12620 [run_manager.py:_on_file_modified():682] file/dir modified: C:\Users\kyuree\dev\ai601\wandb\run-20191107_052909-rzpagbj8\wandb-metadata.json
-2019-11-07 14:29:27,660 DEBUG   MainThread:12620 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-07 14:29:28,043 DEBUG   MainThread:12620 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 521
-2019-11-07 14:29:28,714 DEBUG   Thread-33 :12620 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-07 14:29:29,003 DEBUG   Thread-13 :12620 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /files/sc2rl/ai607/rzpagbj8/file_stream HTTP/1.1" 200 311
-2019-11-07 14:29:29,104 DEBUG   Thread-33 :12620 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 761
-2019-11-07 14:29:29,118 DEBUG   Thread-33 :12620 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): storage.googleapis.com:443
-2019-11-07 14:29:29,242 DEBUG   Thread-13 :12620 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /files/sc2rl/ai607/rzpagbj8/file_stream HTTP/1.1" 200 308
-2019-11-07 14:29:29,245 INFO    MainThread:12620 [run_manager.py:_sync_etc():1383] rendering summary
-2019-11-07 14:29:29,248 INFO    MainThread:12620 [run_manager.py:_sync_etc():1416] syncing files to cloud storage
-2019-11-07 14:29:29,592 DEBUG   Thread-33 :12620 [connectionpool.py:_make_request():437] https://storage.googleapis.com:443 "PUT /wandb-production.appspot.com/sc2rl/ai607/rzpagbj8/___batch_archive_2.tgz?Expires=1573104629&GoogleAccessId=gorilla-cloud-storage%40wandb-production.iam.gserviceaccount.com&Signature=afHrMu59H2reST5A3rXeVhuWyPon6QE%2B%2F9Oalt6IzVF%2BtPzrSjFoFv7b60jyYDy8hKuprsmw31zeNtr0NeZOHFIF1yRlfK9LApURrA%2FW%2FL%2Bv5k4uptwpAS%2Bl%2B%2F4ur%2B3ONWGz1rezkHgzgixtE9S8xNbpyO2XUJ06UMTce3moosLgnlf7oVd5dOsje8VuO5T2QgnsF1LScznhNEGZ24yy8yjxUsuEo3h3ax9Yiamx67ITqdnn23HTLW8QxmxmfeMrfAZAJQAqECVNWyg0kY8HbU1LoQf99fj1%2BDAFCylZfBK3vBNR4s209DQ3vjfK%2Bzohe%2FA5o1sgKqzJ9hHXGlhK9A%3D%3D HTTP/1.1" 200 0
-2019-11-07 14:29:30,756 INFO    MainThread:12620 [run_manager.py:_sync_etc():1431] syncing complete: https://app.wandb.ai/sc2rl/ai607/runs/rzpagbj8
-2019-11-07 14:29:30,756 INFO    MainThread:12620 [rzpagbj8:run_manager.py:_sync_etc():1431] syncing complete: https://app.wandb.ai/sc2rl/ai607/runs/rzpagbj8
+2019-11-07 23:04:33,619 DEBUG   MainThread:14192 [wandb_config.py:_load_defaults():110] no defaults not found in config-defaults.yaml
+2019-11-07 23:04:33,645 DEBUG   MainThread:14192 [util.py:is_cygwin_git():318] Failed checking if running in CYGWIN due to: FileNotFoundError(2, 'The system cannot find the file specified', None, 2, None)
+2019-11-07 23:04:33,650 DEBUG   MainThread:14192 [cmd.py:execute():724] Popen(['git', 'cat-file', '--batch-check'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=<valid stream>)
+2019-11-07 23:04:33,703 DEBUG   MainThread:14192 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-07 23:04:33,767 DEBUG   MainThread:14192 [cmd.py:execute():724] Popen(['git', 'status', '--porcelain', '--untracked-files'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-07 23:04:33,902 DEBUG   MainThread:14192 [run_manager.py:__init__():535] Initialized sync for ai607/unws5l4r
+2019-11-07 23:04:33,907 INFO    MainThread:14192 [run_manager.py:wrap_existing_process():1131] wrapping existing process 12888
+2019-11-07 23:04:33,910 DEBUG   MainThread:14192 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): pypi.org:443
+2019-11-07 23:04:34,502 DEBUG   MainThread:14192 [connectionpool.py:_make_request():437] https://pypi.org:443 "GET /pypi/wandb/json HTTP/1.1" 200 37669
+2019-11-07 23:04:34,630 INFO    Thread-7  :14192 [run_manager.py:_on_file_created():671] file/dir created: C:\Users\kyuree\dev\ai601\wandb\run-20191107_140432-unws5l4r\output.log
+2019-11-07 23:04:34,805 INFO    MainThread:14192 [run_manager.py:init_run():916] system metrics and metadata threads started
+2019-11-07 23:04:34,812 INFO    MainThread:14192 [run_manager.py:init_run():950] upserting run before process can begin, waiting at most 10 seconds
+2019-11-07 23:04:34,838 DEBUG   Thread-20 :14192 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
+2019-11-07 23:04:35,267 DEBUG   Thread-20 :14192 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 473
+2019-11-07 23:04:35,291 INFO    Thread-20 :14192 [run_manager.py:_upsert_run():1035] saving patches
+2019-11-07 23:04:35,292 DEBUG   Thread-20 :14192 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-07 23:04:35,391 DEBUG   Thread-20 :14192 [cmd.py:execute():724] Popen(['git', 'diff', '--cached', '--abbrev=40', '--full-index', '--raw'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-07 23:04:35,454 DEBUG   Thread-20 :14192 [cmd.py:execute():724] Popen(['git', 'version'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
