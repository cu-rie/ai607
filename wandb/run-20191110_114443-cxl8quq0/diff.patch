diff --git a/.idea/workspace.xml b/.idea/workspace.xml
index eae739c..0fd630d 100644
--- a/.idea/workspace.xml
+++ b/.idea/workspace.xml
@@ -4,7 +4,8 @@
     <list default="true" id="fe72474c-d158-4d71-bfb4-aff9b2b6bdbf" name="Default Changelist" comment="">
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/models/Ours.py" beforeDir="false" afterPath="$PROJECT_DIR$/models/Ours.py" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/train_ours.py" beforeDir="false" afterPath="$PROJECT_DIR$/train_ours.py" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/wandb/debug.log" beforeDir="false" afterPath="$PROJECT_DIR$/wandb/debug.log" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/wandb/run-20191110_113825-bv0vw1nm/wandb-metadata.json" beforeDir="false" afterPath="$PROJECT_DIR$/wandb/run-20191110_113825-bv0vw1nm/wandb-metadata.json" afterDir="false" />
     </list>
     <option name="EXCLUDED_CONVERTED_TO_IGNORED" value="true" />
     <option name="SHOW_DIALOG" value="false" />
@@ -194,15 +195,6 @@
     </task>
     <servers />
   </component>
-  <component name="TodoView">
-    <todo-panel id="selected-file">
-      <is-autoscroll-to-source value="true" />
-    </todo-panel>
-    <todo-panel id="all">
-      <are-packages-shown value="true" />
-      <is-autoscroll-to-source value="true" />
-    </todo-panel>
-  </component>
   <component name="Vcs.Log.Tabs.Properties">
     <option name="TAB_STATES">
       <map>
@@ -219,13 +211,13 @@
       <breakpoints>
         <line-breakpoint enabled="true" suspend="THREAD" type="python-line">
           <url>file://$PROJECT_DIR$/models/Ours.py</url>
-          <line>50</line>
+          <line>53</line>
           <option name="timeStamp" value="1" />
         </line-breakpoint>
         <line-breakpoint enabled="true" suspend="THREAD" type="python-line">
           <url>file://$PROJECT_DIR$/models/Ours.py</url>
-          <line>32</line>
-          <option name="timeStamp" value="2" />
+          <line>48</line>
+          <option name="timeStamp" value="3" />
         </line-breakpoint>
       </breakpoints>
     </breakpoint-manager>
diff --git a/models/Ours.py b/models/Ours.py
index 5615413..2f7b1b3 100644
--- a/models/Ours.py
+++ b/models/Ours.py
@@ -16,11 +16,12 @@ class OurNetwork(nn.Module):
                  dropout=0.5):
         super(OurNetwork, self).__init__()
         self.layers = nn.ModuleList()
+        self.num_layers = n_layers
         # input layer
         self.layers.append(
             OurLayer(input_dim, n_hidden, n_nodes, activation=activation, use_linear_comb=use_linear_comb))
         # hidden layers
-        for i in range(n_layers - 1):
+        for i in range(n_layers):
             self.layers.append(
                 OurLayer(n_hidden, n_hidden, n_nodes, activation=activation, use_linear_comb=use_linear_comb))
         # output layer
@@ -30,7 +31,7 @@ class OurNetwork(nn.Module):
         self.use_intermediate_embedding = use_intermediate_embedding
         if use_intermediate_embedding:
             self.intermediate_layer = nn.ModuleList()
-            self.intermediate_layer.append(nn.Linear(input_dim, n_classes))
+            # self.intermediate_layer.append(nn.Linear(input_dim, n_classes))
             for i in range(n_layers - 1):
                 self.intermediate_layer.append(nn.Linear(n_hidden, n_classes))
             self.out_layer = nn.Linear(n_layers+1, n_classes)
@@ -43,10 +44,12 @@ class OurNetwork(nn.Module):
             for i, layer in enumerate(self.layers):
                 if i != 0:
                     h = self.dropout(h)
-                h = layer(graph, h)
-                intermediate_embedding = self.intermediate_layer[i](h)  # shape = (# nodes * num_out)
-                intermediate_embedding.append(intermediate_embedding)
+                h = layer(graph, h) # shape = (# nodes * hidden)
+                if i != self.num_layers:
+                    intermediate_embedding = self.intermediate_layer[i](h)  # shape = (# nodes * num_classes)
+                    intermediate_embeddings.append(intermediate_embedding)
 
+            intermediate_embeddings.append(h)
             concatenated_intermediate_features = torch.cat(intermediate_embeddings, dim=-1)
             out = self.out_layer(concatenated_intermediate_features)
 
diff --git a/wandb/debug.log b/wandb/debug.log
index 87a52e8..b8774cd 100644
--- a/wandb/debug.log
+++ b/wandb/debug.log
@@ -1,19 +1,19 @@
-2019-11-10 20:38:28,340 DEBUG   MainThread:12736 [wandb_config.py:_load_defaults():110] no defaults not found in config-defaults.yaml
-2019-11-10 20:38:28,383 DEBUG   MainThread:12736 [util.py:is_cygwin_git():318] Failed checking if running in CYGWIN due to: FileNotFoundError(2, 'The system cannot find the file specified', None, 2, None)
-2019-11-10 20:38:28,388 DEBUG   MainThread:12736 [cmd.py:execute():724] Popen(['git', 'cat-file', '--batch-check'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=<valid stream>)
-2019-11-10 20:38:28,458 DEBUG   MainThread:12736 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-10 20:38:28,526 DEBUG   MainThread:12736 [cmd.py:execute():724] Popen(['git', 'status', '--porcelain', '--untracked-files'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-10 20:38:28,604 DEBUG   MainThread:12736 [run_manager.py:__init__():535] Initialized sync for gnnproject/bv0vw1nm
-2019-11-10 20:38:28,613 INFO    MainThread:12736 [run_manager.py:wrap_existing_process():1131] wrapping existing process 2204
-2019-11-10 20:38:28,618 DEBUG   MainThread:12736 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): pypi.org:443
-2019-11-10 20:38:29,229 DEBUG   MainThread:12736 [connectionpool.py:_make_request():437] https://pypi.org:443 "GET /pypi/wandb/json HTTP/1.1" 200 37669
-2019-11-10 20:38:29,367 INFO    Thread-18 :12736 [run_manager.py:_on_file_created():671] file/dir created: C:\Users\kyuree\dev\ai601\wandb\run-20191110_113825-bv0vw1nm\wandb-metadata.json
-2019-11-10 20:38:29,558 INFO    MainThread:12736 [run_manager.py:init_run():916] system metrics and metadata threads started
-2019-11-10 20:38:29,558 INFO    MainThread:12736 [run_manager.py:init_run():950] upserting run before process can begin, waiting at most 10 seconds
-2019-11-10 20:38:29,595 DEBUG   Thread-43 :12736 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
-2019-11-10 20:38:30,073 DEBUG   Thread-43 :12736 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 484
-2019-11-10 20:38:30,110 INFO    Thread-43 :12736 [run_manager.py:_upsert_run():1035] saving patches
-2019-11-10 20:38:30,112 DEBUG   Thread-43 :12736 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-10 20:38:30,197 DEBUG   Thread-43 :12736 [cmd.py:execute():724] Popen(['git', 'diff', '--cached', '--abbrev=40', '--full-index', '--raw'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-10 20:38:30,260 DEBUG   Thread-43 :12736 [cmd.py:execute():724] Popen(['git', 'diff', '--abbrev=40', '--full-index', '--raw'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
-2019-11-10 20:38:30,354 DEBUG   Thread-43 :12736 [cmd.py:execute():724] Popen(['git', 'version'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-10 20:44:46,804 DEBUG   MainThread:12108 [wandb_config.py:_load_defaults():110] no defaults not found in config-defaults.yaml
+2019-11-10 20:44:46,851 DEBUG   MainThread:12108 [util.py:is_cygwin_git():318] Failed checking if running in CYGWIN due to: FileNotFoundError(2, 'The system cannot find the file specified', None, 2, None)
+2019-11-10 20:44:46,856 DEBUG   MainThread:12108 [cmd.py:execute():724] Popen(['git', 'cat-file', '--batch-check'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=<valid stream>)
+2019-11-10 20:44:46,916 DEBUG   MainThread:12108 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-10 20:44:46,976 DEBUG   MainThread:12108 [cmd.py:execute():724] Popen(['git', 'status', '--porcelain', '--untracked-files'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-10 20:44:47,055 DEBUG   MainThread:12108 [run_manager.py:__init__():535] Initialized sync for gnnproject/cxl8quq0
+2019-11-10 20:44:47,068 INFO    MainThread:12108 [run_manager.py:wrap_existing_process():1131] wrapping existing process 12004
+2019-11-10 20:44:47,073 DEBUG   MainThread:12108 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): pypi.org:443
+2019-11-10 20:44:47,473 DEBUG   MainThread:12108 [connectionpool.py:_make_request():437] https://pypi.org:443 "GET /pypi/wandb/json HTTP/1.1" 200 37669
+2019-11-10 20:44:47,655 INFO    MainThread:12108 [run_manager.py:init_run():916] system metrics and metadata threads started
+2019-11-10 20:44:47,656 INFO    MainThread:12108 [run_manager.py:init_run():950] upserting run before process can begin, waiting at most 10 seconds
+2019-11-10 20:44:47,700 DEBUG   Thread-43 :12108 [connectionpool.py:_new_conn():959] Starting new HTTPS connection (1): api.wandb.ai:443
+2019-11-10 20:44:47,822 INFO    Thread-18 :12108 [run_manager.py:_on_file_created():671] file/dir created: C:\Users\kyuree\dev\ai601\wandb\run-20191110_114443-cxl8quq0\output.log
+2019-11-10 20:44:48,122 DEBUG   Thread-43 :12108 [connectionpool.py:_make_request():437] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 484
+2019-11-10 20:44:48,161 INFO    Thread-43 :12108 [run_manager.py:_upsert_run():1035] saving patches
+2019-11-10 20:44:48,163 DEBUG   Thread-43 :12108 [cmd.py:execute():724] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-10 20:44:48,245 DEBUG   Thread-43 :12108 [cmd.py:execute():724] Popen(['git', 'diff', '--cached', '--abbrev=40', '--full-index', '--raw'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-10 20:44:48,330 DEBUG   Thread-43 :12108 [cmd.py:execute():724] Popen(['git', 'diff', '--abbrev=40', '--full-index', '--raw'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
+2019-11-10 20:44:48,433 DEBUG   Thread-43 :12108 [cmd.py:execute():724] Popen(['git', 'version'], cwd=C:\Users\kyuree\dev\ai601, universal_newlines=False, shell=None, istream=None)
diff --git a/wandb/run-20191110_113825-bv0vw1nm/wandb-metadata.json b/wandb/run-20191110_113825-bv0vw1nm/wandb-metadata.json
index ecd87af..ce895a3 100644
--- a/wandb/run-20191110_113825-bv0vw1nm/wandb-metadata.json
+++ b/wandb/run-20191110_113825-bv0vw1nm/wandb-metadata.json
@@ -19,5 +19,5 @@
     "mode": "run",
     "name": "DEBUG",
     "project": "gnnproject",
-    "heartbeatAt": "2019-11-10T11:38:45.572610"
+    "heartbeatAt": "2019-11-10T11:41:09.769356"
 }
